## 文件

+ 参数文件：告诉MySQL实例启动时，在哪里可以找到数据库文件，并且指定某些初始化参数，这些参数定义了某种内存结构的大小设置，还会介绍各种参数的类型。

+ 日志文件：用来记录MySQL实例对某种条件做出响应时应写入的文件，如错误日志文件、二进制文件、慢查询日志文件、查询日志文件等。

+ socket文件：当用UNIX域套接字方式进行连接时需要的文件

+ pid文件：MySQL实例的进程ID文件。

+ MySQL表结构文件：用来存放MySQL表结构定义文件。

+ 存储引擎文件：因为MySQL表存储引擎的关系，每个存储引擎都会有自己的文件来保存各种数据。这些存储引擎真正存储了记录和索引等数据。

  ### 日志文件

  &emsp;日志文件记录了影响MySQL数据库的各种类型活动。MySQL数据库中常见的日志文件有：

  + 错误日志(error log)
  + 二进制日志(binlog)
  + 慢查询日志(slow query log)
  + 查询日志(log)

#### 错误日志

&emsp;错误日志文件对MySQL的启动、运行、关闭过程进行了记录。

#### 慢查询日志

慢查询日志可以帮助DBA定位可能存在问题的SQL语句，从而进行SQL语句层面的优化。例如，可以在MySQL启动时设置一个阈值，将运行时间超过该值的所有SQL语句都记录到慢查询日志文件中。该阈值可以通过参数long_query_time来设置，默认值为10，代表10秒。运行时间正好等于long_query_time的情况并不会被记录下。从MySQL5.1开始，long_query_time开始以微秒记录SQL语句运行时间。

#### 查询日志

&emsp;查询日志记录了所有对MySQL数据库请求的信息，无论这些请求是否得到了正确的执行。默认文件名：主机名.log。

#### 二进制日志

&emsp;二进制日志（binary log）记录了对MySQL数据库执行更改的所有操作，但是不包括SELECT和SHOW这类操作，因为这类操作对数据本身并没有修改。此外，二进制日志还包括了执行数据库更改操作的时间等其他额外信息。

&emsp;总的来说，二进制日志主要有以下几种作用。

+ 恢复(recovery) : 某些数据的恢复需要二进制日志，例如，在一个数据库全被文件恢复后，用户可以通过二进制日志进行point-in-time的恢复。
+ 复制（replication）: 其原理域恢复类似，通过复制和执行二进制日志使一台远程的MySQL数据库（一般称为slave或standby）与一台MySQL数据库（一般称为master或primary）进行实时同步。
+ 审计（audit）: 用户可以通过二进制日志中的信息来进行审计，判断是否有对数据库进行注入的攻击。

### InnoDB存储引擎文件

#### 表空间文件

&emsp;InnoDB采用将存储的数据按表空间（tablespace）进行存放的设计。在默认配置下会有一个初始大小为10MB，名为ibdatal的文件。该文件就是默认的表空间文件。

#### 重做日志文件

&emsp;在默认情况下，在InnoDB存储引擎的数据目录下会有两个名为ib_logfile0和ib_logfile1的文件。这就是重做日志文件，记录了InnoDB存储引擎的事务日志。

&emsp;当实例或介质失败（media failure）时，重做日志文件就能排上用场。例如，数据库由于所在主机掉电导致实例失败，InnoDB存储引擎会使用重做日志恢复到掉电前的时刻，以此来保证数据的完整性。

&emsp;每个InnoDB存储引擎至少有1个重做日志文件组（group），每个文件组下至少有2个重做日志文件，如默认的ib_logfile0和ib_logfile1。为了得到更高的可靠性，用户可以设置多个的镜像日志组，将不同的文件放在不同的磁盘上，以此提高重做日志的高可用性。

&emsp;与二进制日志文件的区别：

+ 二进制日志会记录所有与MySQL数据库有关的日志记录，包括InnoDB、MyISAM、Heap等其他存储引擎的日志。而InnoDB存储引擎的重做日志只记录有关该存储引擎本身的事务日志。
+ 记录的内容不同，无论用户将二进制日志文件记录的格式设为STATEMENT还时ROW，又或者是MIXED，其记录都是关于一个事务的具体操作内容，即该日志是逻辑日志。而InnoDB存储引擎的重做日志文件的是关于每个页的更改的物理情况。
+ 写入的时间也不同，二进制日志文件仅在事务提交前进行提交，即致谢磁盘以此，不论这时该事务多大。而在事务进行的过程中，却不断又重做日志条目被写入到重做日志文件中。

&emsp;写入重做日志文件的操作不是直接写，而是先写入一个重做日志缓冲（redo log buffer）中，然后按照一定的条件顺序地写入日志文件。

![1570107671373](C:\Users\施文波\AppData\Roaming\Typora\typora-user-images\1570107671373.png)





